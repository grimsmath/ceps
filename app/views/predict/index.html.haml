.col-md-12
  .panel.panel-primary
    .panel-heading
      %h4.panel-title
        Predict Enrollment

    .panel-body
      .col-md-12
        .acc-wizard
          .col-md-3
            %ol.acc-wizard-sidebar
              %li.acc-wizard-todo
                %a{href: '#semester'}
                  Select Current Semester
              %li.acc-wizard-todo
                %a{href: '#courses'}
                  Select Courses
              %li.acc-wizard-todo
                %a{href: '#date'}
                  Select Date Range
              %li.acc-wizard-todo
                %a{href: '#review'}
                  Review Selection
              %li.acc-wizard-todo
                %a{href: '#finish'}
                  Run Prediction

          .col-md-9
            #accordion.panel-group
              .panel.panel-default
                .panel-heading
                  %h4.panel-title
                    %a{href: "#semester", data: {toggle: "collapse", parent: "#accordion"}}
                      STEP 1: Select Current Semester

                #semester.panel-collapse.collapse.in
                  .panel-body
                    %form(id="select-semester")
                      .form-group
                        = select("semester", "semester_id", Semester.all.collect {|p| [ p.title, p.id ] }, {include_blank: 'Please select...'}, class: "form-control")

              .panel.panel-default
                .panel-heading
                  %h4.panel-title
                    %a{href: "#courses", data: {toggle: "collapse", parent: "#accordion"}}
                      STEP 2: Select Courses

                #courses.panel-collapse.collapse.in
                  .panel-body
                    %form(id="select-courses")
                      .row
                        .col-md-5
                          .form-group
                            %label.form-label Available Courses
                            %select#course-select.form-control{multiple: 'true', size: '10'}

                        .col-md-2
                          %div(style="margin-top: 75px")
                            %button#select-course.btn.btn-block.btn-big.btn-primary
                              Select
                              %i.fa.fa-angle-double-right

                            %button#deselect-course.btn.btn-block.btn-big.btn-primary
                              %i.fa.fa-angle-double-left
                              Deselect

                        .col-md-5
                          .form-group
                            %label.form-label Selected Courses
                            %select#course-dest.form-control{multiple: 'true', size: '10'}

              .panel.panel-default
                .panel-heading
                  %h4.panel-title
                    %a{href: "#date", data: {toggle: "collapse", parent: "#accordion"}}
                      STEP 3: Select Date Range

                #date.panel-collapse.collapse.in
                  .panel-body
                    %form(id="select-date")
                      .row
                        .col-md-6
                          .form-group
                            %label.form-label Starting Semester
                            = select("start", "semester_id", Semester.all.collect {|p| [ p.title, p.id ] }, {include_blank: 'Please select...'}, class: "form-control")

                        .col-md-6
                          .form-group
                            %label.form-label Ending Semester
                            = select("end", "semester_id", Semester.all.collect {|p| [ p.title, p.id ] }, {include_blank: 'Please select...'}, class: "form-control")

              .panel.panel-default
                .panel-heading
                  %h4.panel-title
                    %a{href: "#review", data: {toggle: "collapse", parent: "#accordion"}}
                      STEP 4: Review Selections

                #review.panel-collapse.collapse.in
                  .panel-body
                    %form(id="review-selections")
                      .bs-callout.bs-callout-info
                        %h4 You have selected the following options for the prediction scenario
                        %table.table.table-striped
                          %tr
                            %td(style="width: 200px")
                              <strong>Current Semester:</strong>
                            %td
                              #review-current-semester
                          %tr
                            %td(style="width: 200px")
                              <strong>Selected Courses:</strong>
                            %td
                              %ul#review-selected-courses(style="list-style-type: none; list-style-position: outside; margin: 0px; padding: 0px")
                          %tr
                            %td(style="width: 200px")
                              <strong>Starting Semester:</strong>
                            %td
                              #review-start-date
                          %tr
                            %td(style="width: 200px")
                              <strong>Ending Semester:</strong>
                            %td
                              #review-end-date

              .panel.panel-default
                .panel-heading
                  %h4.panel-title
                    %a{href: "#finish", data: {toggle: "collapse", parent: "#accordion"}}
                      STEP 5: Run Prediction

                #finish.panel-collapse.collapse.in
                  .panel-body
                    %form(id="run-prediction")
                      .row
                        .col-md-12
                          %button.btn.btn-primary.btn-lg
                            Run Query


:coffee
  onNext = (parent, panel) ->
    hash = "#" + panel.id;
    $(".acc-wizard-sidebar",$(parent))
        .children("li")
        .children("a[href='" + hash + "']")
        .parent("li")
        .removeClass("acc-wizard-todo")
        .addClass("acc-wizard-completed");

  $(".acc-wizard").accwizard
    onNext: onNext

  $('#semester_semester_id').change ->
    $.get '/courses_by_semester/' + $('#semester_semester_id').val(), (data) ->
      $('#course-select').empty()
      $('#course-dest').empty()
      $('#review-current-semester').text($('#semester_semester_id option:selected').text())

      for e in data
        option = $('<option></option>').attr('value', e.number).text(e.number + ' - ' + e.title);
        $("#course-select").append(option);

  $('#select-course').click ->
    $("#course-select option:selected").each ->

      val = $(this).val()
      text = $(this).text()

      option = $('<option></option>').attr('value', val).text(text);
      $("#course-dest").append(option);

      li = $('<li></li>').text(text)
      $('#review-selected-courses').append(li)

  $('#deselect-course').click ->
    $("#course-dest option:selected").remove()

  $('#start_semester_id').change ->
    $('#review-start-date').text($("#start_semester_id option:selected").text())

  $('#end_semester_id').change ->
    $('#review-end-date').text($("#end_semester_id option:selected").text())
